import sys
import random
import argparse
import requests


def enumerate(arg):
    subdoms = wordlist(args.wordlist).splitlines()
    loading = "|/-\\-"
    n = 0

    for sub in subdoms:
        sub_domains = f"http://{sub}.{arg}" 
        try:
            requests.get(sub_domains)
        except requests.ConnectionError:
            sys.stdout.write("\rSearching " + loading[random.randint(0, 4) % len(loading)])
            sys.stdout.flush()
            pass
        else:
            print("\rValid domain: ",sub_domains)
            n+=1 
    print(f"\rFound domains: {n}")
    
def wordlist(args):
        try:
            wordlist = open(args).read()
        except TypeError:
            print("You need to specify wordlist to use")
            sys.exit()
        except FileNotFoundError:
            print("Wordlist not found. Check filename, path or extension.")
            sys.exit()
        finally: 
            return wordlist

parser = argparse.ArgumentParser()
parser.add_argument('-e', '--enumerate')
parser.add_argument('-w', '--wordlist')
args = parser.parse_args(['--enumerate', 'google.pl', '--wordlist', 'Python/pentest-tools/src/doms1.txt'])
print(args)

if args.enumerate:
    enumerate(args.enumerate)